sudo: required

services:
  - docker

before_install:
  - git clone https://github.com/apiaryio/drafter drafter
  - cd drafter; git checkout v2.1.2; git submodule update --recursive --init

install:
  - docker build -t builder -d Dockerfile.builder .
  - docker run --rm -v "$(pwd)":/out -v drafter:/drafter builder

script:
  - docker build -t christianbladescb/drafter:2.1.2 .

before_deploy:
  - docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"

deploy:
  - docker push christianbladescb/drafter:2.1.2